<ngx-spinner
  bdColor="rgba(51,51,51,0.8)"
  size="medium"
  color="#ccc"
  type="ball-spin">
  <p style="font-size: 16px; color: #ccc" translate>componente-ngx-spinner.grabando</p>
</ngx-spinner>

<!-- *************** LISTADO ************************************ -->
<div *ngIf="accionForm=='listado'">

    <div translate>{{errorMensaje}} </div>

    <div class="row tituloRow">
        <div class="col-lg-12 col-12">        
            <span class="tituloTexto">
                <b>{{'menu.organizaciones' | translate}}</b>
            </span>                
        </div>
    </div>
    
    <div widget class="card border-0 box-shadow" >
        <div class="card-header transparent border-0 text-muted">
            <div class="widget-controls"> 
                <a data-widgster="expand" href="#" class="transition"><i class="fa fa-chevron-down"></i></a>
            </div>        
        </div>
        <div class="card-body pt-0 widget-body"> 

            <div  class="row" >
                <div class="col-12">
                    
                    <table class="table table-hover"
                           [ngClass]="!grilla.verFiltrosAdicionales ? 'Grilla1FilaFiltros' : 'Grilla2FilaFiltros'">
                           
                        <thead>
                            
                            <!--------------- Filtros -------------------->
                            <tr> 
                                <th *ngIf="tipoPerfilUsuario=='Desarrollador' && grilla.verColumnaKey">
                                    <input [(ngModel)]="grilla.filtros['key']" *ngIf="grilla.mostrarFiltro('key')"
                                           type="text" class="form-control filtroGrilla" 
                                           placeholder="{{'moduloDesarrolladores.key' | translate}}">
                                </th>
                                <th *ngIf="tipoPerfilUsuario=='Desarrollador' && grilla.verColumnaKey">
                                    <input type="text" [(ngModel)]="grilla.filtros['autoIncrement']" class="form-control filtroGrilla" placeholder="{{'moduloDesarrolladores.autoIncrement' | translate}}">
                                </th>
                                <th *ngIf="tipoPerfilUsuario=='Desarrollador' && !grilla.verColumnaKey"
                                    colspan="2" style="width:24px; padding-left:0px; padding-right:0px;"></th>
                                
                                <th>
                                    <input type="text" [(ngModel)]="grilla.filtros['nombre']" 
                                           class="form-control filtroGrilla"
                                           placeholder="{{'claseFicha.nombre' | translate}}">
                                </th> 
                                <th></th> <!-- logo -->
                                <th>
                                    <input type="text" [(ngModel)]="grilla.filtros['direccion.calle']" 
                                           class="form-control filtroGrilla"
                                           placeholder="{{'claseDireccion.direccion' | translate}}">
                                </th> 
                                <th>
                                    <input type="text" [(ngModel)]="grilla.filtros['direccion.ciudad']" 
                                           class="form-control filtroGrilla"
                                           placeholder="{{'claseDireccion.ciudad' | translate}}">
                                </th> 
                                <th *ngIf="tipoPerfilUsuario=='Desarrollador'">
                                    <input type="text" [(ngModel)]="grilla.filtros['distribuidor.nombre']" 
                                           class="form-control filtroGrilla"
                                           placeholder="{{'moduloDistribuidores.distribuidor' | translate}}">
                                </th> 
                                <th>
                                    <select class="form-control selectpicker filtroGrilla" 
                                            [(ngModel)]="grilla.filtros['settings.isActivo']">
                                        <option *ngFor="let item of LISTA_DE_FILTROS_SI_NO" [ngValue]="item.logic"> {{item.val | translate}}</option>
                                    </select>
                                </th>                                 

                                <th class="align-middle" style="padding-top:0px; padding-bottom:0px;">
                                    <button title="{{'navegabilidad.reset' | translate}}"
                                            class="btn btn-link btn-lg"
                                            (click)="resetFiltros()"><i class="fa fa-eraser ml-3 text-secondary"></i></button>
                                </th>
                                
                            </tr>
                            
                            <!-- --------- Columnas ------------- -->    
                            <tr class="titulo-grilla"> 
                                <th *ngIf="tipoPerfilUsuario=='Desarrollador' && grilla.verColumnaKey"
                                    [class.active]="grilla.orderField === 'key'"
                                    (click)="onChangeGrilla('order','key')" style="padding-bottom:0px;">

                                        <button class="btn btn-link btn-lg"  
                                            style="padding-left:0px; padding-top:0px; margin-right:30px;"
                                            title="{{'grilla.ocultarKey' | translate}}" 
                                            *ngIf="permisos.altasAutorizadas" 
                                            (click)="grilla.verColumnaKey=!grilla.verColumnaKey"><i class="mdi mdi-unfold-less-vertical mdi-24px text-dark"
                                           aria-hidden="true"></i></button>

                                        {{'moduloDesarrolladores.key' | translate}}<span [hidden]="grilla.orderReverse">▼</span><span [hidden]="!grilla.orderReverse">▲</span>
                                </th>
                                <th *ngIf="tipoPerfilUsuario=='Desarrollador' && grilla.verColumnaKey"
                                    [class.active]="grilla.orderField === 'autoIncrement'" class="text-center"
                                    (click)="onChangeGrilla('order','autoIncrement')">{{'moduloDesarrolladores.autoIncrement' | translate}}<span [hidden]="grilla.orderReverse">▼</span><span [hidden]="!grilla.orderReverse">▲</span>
                                </th>
                                <th *ngIf="tipoPerfilUsuario=='Desarrollador' && !grilla.verColumnaKey"
                                 (click)="grilla.verColumnaKey=!grilla.verColumnaKey" title="{{'grilla.mostrarKey' | translate}}"
                                        colspan="2"
                                        style="width:10px; padding-left:0px; padding-right:0px; text-align:center;">
                                    ...
                                </th>

                                <th [class.active]="grilla.orderField === 'nombre'"
                                    (click)="onChangeGrilla('order','nombre')"
                                    class="mdl-data-table__cell--non-numeric" translate>claseFicha.nombre<span [hidden]="grilla.orderReverse">▼</span><span [hidden]="!grilla.orderReverse">▲</span>
                                </th> 

                                <th [class.active]="grilla.orderField === 'logo'" style="width:50px;"
                                    (click)="onChangeGrilla('order','nombre')"
                                    translate>claseFicha.logo<span [hidden]="grilla.orderReverse">▼</span><span [hidden]="!grilla.orderReverse">▲</span>
                                </th> 

                                <th [class.active]="grilla.orderField === 'direccion.calle'" colspan="2"
                                    (click)="onChangeGrilla('order','direccion.calle')" translate>claseDireccion.direccion<span [hidden]="grilla.orderReverse">▼</span><span [hidden]="!grilla.orderReverse">▲</span>
                                </th> 

                                <th *ngIf="tipoPerfilUsuario=='Desarrollador'"
                                    [class.active]="grilla.orderField === 'telefono.nombreDistribuidor'"
                                    (click)="onChangeGrilla('order','nombreDistribuidor')" translate>moduloDistribuidores.distribuidor<span [hidden]="grilla.orderReverse">▼</span><span [hidden]="!grilla.orderReverse">▲</span>
                                </th> 

                                <th [class.active]="grilla.orderField === 'settings.isActivo'" class="text-center"
                                    (click)="onChangeGrilla('order','settings.isActivo')" translate>claseFicha.activo<span [hidden]="grilla.orderReverse">▼</span><span [hidden]="!grilla.orderReverse">▲</span>
                                </th>                                 
                                
                                <th style="padding-left:0px; padding-right:0px;">
                                    <button class="btn btn-link btn-lg" style="padding-left:0px; padding-right:0px;"
                                            title="{{'navegabilidad.agregar' | translate}}"
                                            *ngIf="permisos.altasAutorizadas" 
                                            (click)="abrirFormulario(null)"><i class="fa fa-plus ml-3 text-success"></i></button>

                                    <!-- <button class="btn btn-link btn-lg" style="padding-left:0px; padding-right:0px;"
                                            data-toggle="tooltip" 
                                            title="{{'componente-listado.importar' | translate}}"
                                            *ngIf="permisos.altasAutorizadas" 
                                            (click)="fileInput.click()"><input #fileInput style="display:none;"  type="file" (change)="importExcel($event)" /><i class="fa fa-cloud-upload ml-3 text-dark"></i></button> -->
                                </th>

                            </tr>

                        </thead>
                        
                        <tbody>

                            <!-- ----------------------------------------------------------------- -->
                            <!-- ------- Orden, Filtros y Paginado ------------------------------- -->
                            <!-- ----------------------------------------------------------------- -->
                            
                            <ng-container *ngFor="let documento of listadoPrincipal 
                                            | orderBy :grilla.orderField :grilla.orderReverse :'case-insensitive'                                        
                                            
                                            | searchFiltro:grilla.paginadoTipo:'key':grilla.filtros['key']
                                            | searchFiltro:grilla.paginadoTipo:'AutoIncrement':grilla.filtros['AutoIncrement']
                                            | searchFiltro:grilla.paginadoTipo:'nombre':grilla.filtros['nombre']
                                            | searchFiltro:grilla.paginadoTipo:'direccion.calle':grilla.filtros['direccion.calle']
                                            | searchFiltro:grilla.paginadoTipo:'distribuidor.nombre':grilla.filtros['distribuidor.nombre']
                                            | searchFiltro:grilla.paginadoTipo:'settings.isActivo':grilla.filtros['isActivo']:'boolean'   
                                            | searchFiltro:grilla.paginadoTipo:'settings.borradoFisico':false:'boolean'   
                                            | paginate: { itemsPerPage: grilla.paginadoCantidad, 
                                              currentPage : pagePaginado,
                                              totalItems  : grilla.resultCantidad }; 
                                              let index = index"> 

                                <tr [ngStyle]="grilla.colorFilaSegunEstado(documento.settings)"
                                    (mouseover)="grilla.keyHoverActivo=documento.key"
                                    (mouseout)="grilla.keyHoverActivo=null"              
                                    [ngClass]="grilla.keyHoverActivo==documento.key ? 'trHover' : 'trNotHover'">
                                              
                                    <td *ngIf="tipoPerfilUsuario=='Desarrollador' && grilla.verColumnaKey"
                                        class="align-middle"
                                        (click)="abrirFormulario(documento)"> 
                                        <span class="align-left">{{documento.key}}</span>
                                    </td>
                                    <td *ngIf="tipoPerfilUsuario=='Desarrollador' && grilla.verColumnaKey"
                                        class="align-middle text-center"
                                        (click)="abrirFormulario(documento)"> 
                                        <span class="align-left">{{documento.autoIncrement}}</span>
                                    </td>
                                    <td *ngIf="tipoPerfilUsuario=='Desarrollador' && !grilla.verColumnaKey"
                                        (click)="grilla.verColumnaKey=!grilla.verColumnaKey"
                                        colspan="2"
                                        style="width:12px; padding-left:0px; padding-right:0px;"></td>

                                    <td class="align-middle" (click)="abrirFormulario(documento)">
                                        <span class="align-middle">{{documento.nombre}}</span>                            
                                    </td>    

                                    <td class="align-middle" (click)="abrirFormulario(documento)">
                                        <!-- logo -->
                                        <div class="image-wrapper" style="padding-top:0px; margin-top:0px;">
                                           <img *ngIf="documento.logoIMG && documento.logoIMG.linkThumb"
                                                [src]="documento.logoIMG.linkThumb"                                                     
                                                width="100%" style="width:50px; border:1px solid #ccc;">
                                            <img *ngIf="!documento.logoIMG?.linkThumb"
                                                 src="assets/img/app/no-image.png" style="width:50px; border:1px solid #ccc;">
                                        </div>
                                    </td>

                                    <td class="align-middle text-left" colspan="2" (click)="abrirFormulario(documento)">
                                        <span class="align-left text-truncate" 
                                             [ngClass]="documento.settings.isActivo ? 'spanGrillaResaltadoActivo' : 'spanGrillaResaltadoNoActivo'">
                                            {{documento.direccion.calle}}
                                            <span *ngIf="documento.direccion.numero">&nbsp;{{documento.direccion.numero}}</span>
                                            <span *ngIf="documento.direccion.bloque">&nbsp;{{documento.direccion.bloque}}</span>
                                            <span *ngIf="documento.direccion.piso">&nbsp;{{documento.direccion.piso}}</span>
                                            <span *ngIf="documento.direccion.departamento">&nbsp;{{documento.direccion.departamento}}</span><br>
                                        </span>    
                                        {{documento.direccion.ciudad}} 
                                        <span *ngIf="documento.direccion.partido">&nbsp;({{documento.direccion.partido}})</span>
                                    </td>    
     
                                    <td *ngIf="tipoPerfilUsuario=='Desarrollador'" 
                                        class="align-middle" (click)="abrirFormulario(documento)">
                                        {{fn.mostrarKN(documento.distribuidor,'nombre')}}
                                    </td>    

                                    <td class="align-middle text-center" (click)="abrirFormulario(documento)">
                                            <i class="fa fa-check text-secondary" *ngIf="documento.settings.isActivo"></i>
                                    </td>    

                                    <td class="align-middle">
                                        <div class="btn-group" role="group">
                                            <button class="btn btn-link btn-lg" style="padding-left:0px; padding-right:0px;"
                                                    title="{{'navegabilidad.consultar' | translate}}"
                                                    (click)="abrirFormulario(documento)"><i class="fa fa-search mr-3 text-primary"></i></button>

                                            <!-- borrado lógico -->
                                            <button *ngIf="permisos.bajasAutorizadas &&
                                                    documento.settings.documentosAsociados==0 && documento.settings.isBorrado==false" 
                                                    title="{{'navegabilidad.eliminar' | translate}}"
                                                    class="btn btn-link btn-lg"  style="padding-left:0px; padding-right:0px;"
                                                    (click)="deleteDocumento('borradoLogico', documento)"><i class="fa fa-trash mr-3 text-danger"></i></button>

                                            <button *ngIf="permisos.bajasAutorizadas &&
                                                    documento.settings.documentosAsociados>0 && documento.settings.isBorrado==false" 
                                                    title="{{fn.titleMensaje('claseValidaciones.documentosAsociados',documento.settings.documentosAsociados)}}"
                                                    class="btn btn-link btn-lg"  style="padding-left:0px; padding-right:0px;"
                                                    (click)="fn.alertMensaje('claseValidaciones.documentosAsociados',documento.settings.documentosAsociados)"><i class="fa fa-trash mr-3 text-deshabilitado"></i></button>

                                            <!-- borrado físico -->
                                            <button *ngIf="permisos.bajasAutorizadas && documento.settings.isBorrado &&
                                                          ['Desarrollador','Supervisor','Distribuidor'].indexOf(tipoPerfilUsuario)!=-1"
                                                    title="{{'navegabilidad.eliminarFisicamente' | translate}}"
                                                    class="btn btn-link btn-lg" style="padding-left:0px; padding-right:0px;"
                                                    (click)="deleteDocumento('borradoFisico',documento)"><i class="fa fa-remove mr-3 text-danger"></i></button>
                                        </div>
                                    </td>
                                </tr>
                                
                            </ng-container>
                                
                        </tbody>
                    </table>

                    <!-- paginado -->
                    <div class="row" style="border-top:1px solid #ccc;">
                        <div class="col-3" style="padding:10px;">
                            <div class="bg-white text-center">
                                <select class="form-control selectpicker" 
                                        id="grilla.paginadoCantidad"                                         
                                        [(ngModel)]="grilla.paginadoCantidad"
                                        (change)="onChangeGrilla('paginadoCantidad',grilla.paginadoCantidad)"> 
                                    <ng-container *ngFor="let opcion of grilla.paginadoDropDown">
                                        <option [ngValue]="opcion">Items x Página {{opcion}}</option>
                                    </ng-container>
                                </select>
                            </div>    
                        </div>    
                        <div class="col-9" style="padding:10px;">
                            <div class="bg-white text-center">

                                <!-- Paginado Local -->
                                <pagination-controls 
                                    *ngIf="grilla.paginadoTipo=='local'"
                                    autoHide="{{grilla.paginadoAutoHide}}" 
                                    previousLabel="{{'componente-paginado.anterior' | translate}}" 
                                    nextLabel="{{'componente-paginado.siguiente' | translate}}" 
                                    (pageChange)="pagePaginado = $event" 
                                    maxSize="3"></pagination-controls>

                                <!-- Paginado Servidor -->
                                <lib-shared-paginado-servidor 
                                    *ngIf="grilla.paginadoTipo=='servidor'"
                                    [grilla]="grilla" 
                                    (clickPaginado)="emitClickPaginado($event)"></lib-shared-paginado-servidor>

                            </div>
                        </div>                        
                    </div>

                </div>
            </div>

        </div> <!-- FIN card-body -->
    </div> <!-- FIN widget -->

</div>



<!-- *************** FORMULARIO ************************************ -->
<div *ngIf="['agregar','modificar','consultar'].indexOf(accionForm)!=-1">
    
    <div class="row tituloRow">
        <div class="col-lg-12 col-12">        
            <span class="tituloTexto">
                <b>{{'moduloOrganizaciones.organizacion' | translate}}: </b>
                {{form.value.nombre}}
            </span>                
            
            <button type="button" 
                    *ngIf="['modificar','agregar'].indexOf(accionForm)==-1 &&
                           router.url!='/usuarios/fichaOrganizacion'"
                    class="btn btn-warning"  style="float:right;"
                    (click)="setAccionForm('listado')" translate>navegabilidad.salir</button>

        </div>
    </div>
    
    <div class="row">
        <div class="col-lg-12 col-12">

            <div class="clearfix" style="margin-top:10px;">            
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#ta" 
                           translate>claseTabs.ficha</a>
                    </li>

                    <!-- Solapas Activas cuando no estoy editando Ficha -->
                    <li class="nav-item" *ngIf="form.value.key && ['modificar','agregar'].indexOf(accionForm)==-1">
                        <a class="nav-link" data-toggle="tab" href="#tc" translate>claseTabs.areasNegocio</a>
                    </li>
                    <li class="nav-item" *ngIf="form.value.key && ['modificar','agregar'].indexOf(accionForm)==-1">
                        <a class="nav-link" data-toggle="tab" 
                           href="#tb" translate>claseTabs.sucursales</a>
                    </li>
                    <li class="nav-item" *ngIf="form.value.key && ['modificar','agregar'].indexOf(accionForm)==-1">
                        <a class="nav-link" data-toggle="tab" href="#td" translate>claseTabs.ubicaciones</a>
                    </li>

                    <!-- Solapas Deshabilitadas -->
                    <li class="nav-item" *ngIf="form.value.key && ['modificar','agregar'].indexOf(accionForm)!=-1">
                        <a class="nav-link" 
                           href="javascript:;" translate>claseTabs.sucursales</a>
                    </li>
                    <li class="nav-item" *ngIf="form.value.key && ['modificar','agregar'].indexOf(accionForm)!=-1">
                        <a class="nav-link" 
                           href="javascript:;" translate>claseTabs.areasNegocio</a>
                    </li>
                    <li class="nav-item" *ngIf="form.value.key && ['modificar','agregar'].indexOf(accionForm)!=-1">
                        <a class="nav-link" 
                           href="javascript:;" translate>claseTabs.ubicaciones</a>
                    </li>

                </ul>
            </div>
            <div class="tab-content top">

                <div class="tab-pane active" id="ta">
                        <!-- ******************** FICHA ********************* -->

                        <form [formGroup]="form" (ngSubmit)="onSubmit(form.value)"
                              *ngIf="finalizoGETPrincipal && finalizoGETSecundarias">

                                    <lib-shared-form-buttons [accionForm]='accionForm' 
                                                      [permisos]='permisos' 
                                                      (setAccion)="setAccionForm($event)"
                                                      (onSubmitComponent)="onSubmit(form.value)"></lib-shared-form-buttons>

                                    <div class="row px-3" style="margin-top:20px;">

                                        <div class="col-xl-6 mb-4">

                                                <!-- ********* datos generales ********** -->
                                                <div widget class="card border-0 box-shadow">
                                                    <div class="card-header transparent border-0 text-muted">
                                                        <h5 class="mb-0" translate>claseTabs.basic</h5>
                                                        <div class="widget-controls"> 
                                                            <a data-widgster="expand" href="#" class="transition"><i class="fa fa-chevron-down"></i></a>
                                                            <a data-widgster="collapse" href="#" class="transition"><i class="fa fa-chevron-up"></i></a>                                     
                                                        </div>        
                                                    </div>
                                                    <div class="card-body pt-0 widget-body"> 
                                                            
                                                            <div class="row" style="margin-top:10px;"
                                                                *ngIf="['Desarrollador','Supervisor','Distribuidor'].indexOf(tipoPerfilUsuario)!=-1 || accionForm=='agregar'">
                                                                <div class="col-8">
                                                                    <!-- Key -->                                                                    
                                                                    <div class="form-group">
                                                                        <label class="text-gray" translate>{{'moduloDesarrolladores.key' | translate}}</label>
                                                                        <input formControlName="key" id="key" 
                                                                        class="form-control" maxlength="90">  <!-- maxlength="20" -->
                                                                    </div>
                                                                </div>    
                                                                <div class="col-4">
                                                                    <!-- autoIncrement -->
                                                                    <div class="form-group">
                                                                        <label class="text-gray" translate>{{'moduloDesarrolladores.autoIncrement' | translate}}</label>
                                                                        <input formControlName="autoIncrement" 
                                                                        id="autoIncrement" 
                                                                        class="form-control" READONLY>
                                                                    </div>

                                                                </div>    
                                                            </div>    

                                                            <!-- Nombre -->
                                                            <div class="form-group">
                                                                <label class="text-gray" translate>claseFicha.nombre<span class="required">*</span></label>
                                                                <input formControlName="nombre" class="form-control validation-field" type="text">

                                                                <small class="text-danger" *ngIf="form.controls.nombre.touched && form.controls.nombre.errors?.required">
                                                                <span translate>claseFicha.nombre</span>&nbsp;<span translate>claseValidaciones.esRequerido</span></small>                              
                                                                <small class="text-danger" *ngIf="form.controls.nombre.touched && form.controls.nombre.errors?.minlength"><span translate>claseFicha.nombre</span>&nbsp;<span translate [translateParams]="{value: '3'}">claseValidaciones.minimaCantidad</span></small>
                                                            </div>

                                                            <!-- Email -->
                                                            <div class="form-group">
                                                                <label class="text-gray" translate>claseFicha.email<span class="required">*</span></label>
                                                                <input formControlName="email" class="form-control validation-field" type="text">

                                                                <small class="text-danger" *ngIf="form.controls.email.touched && form.controls.email.errors?.required"><span translate>claseFicha.email</span>&nbsp;<span translate>claseValidaciones.esRequerido</span></small>                              
                                                                <small class="text-danger" *ngIf="form.controls.email.touched && form.controls.email.errors?.email"><span translate>claseFicha.email</span>&nbsp;<span translate>claseValidaciones.formatoInvalido</span></small>
                                                            </div>

                                                            <div class="form-group">
                                                                <label class="text-gray" translate>claseFicha.web</label>
                                                                <input formControlName="web" class="form-control validation-field" type="text">
                                                            </div>

                                                            <!-- logoIMG -->
                                                            <div class="form-group" 
                                                                 style="margin-bottom:0px; padding-bottom:0px;">
                                                                <label class="text-gray" translate>claseFicha.logo</label>
                                                                <lib-shared-input-image 
                                                                    [imageField]="'logoIMG'" 
                                                                    [image]="form.value.logoIMG.link"
                                                                    [accionForm]="accionForm" 
                                                                    (desabilitarGrabar)="emitDesabilitarGrabar($event)"
                                                                    (cargoArchivo)="emitCargoArchivo($event)"
                                                                    (borroArchivo)="emitBorroArchivo($event)"></lib-shared-input-image>
                                                            </div>

                                                             <!-- Rubros -->
                                                            <div class="form-group  ">
                                                              <label class="text-gray" translate>claseFicha.rubro<span class="required">*</span></label>
                                                              <select class="form-control selectpicker validation-field" id="rubro" formControlName="rubro"  >
                                                                <option *ngFor="let rubro of LISTA_RUBROS_DE_ORGANIZACIONES | orderBy:'val':false:'case-insensitive'"   [ngValue]="rubro.id"  > {{rubro.val | translate}}</option>
                                                              </select>
                                                              <small *ngIf="form.controls.rubro.touched && form.controls.rubro.errors?.required" class="text-danger"><span translate>claseFicha.rubro</span>&nbsp;<span translate>claseValidaciones.esRequerido</span></small>
                                                            </div>  

                                                            <!-- Idioma -->                                                    
                                                            <div class="form-group">
                                                                <label class="text-gray" translate>idioma.idioma<span class="required">*</span></label>
                                                                <select class="form-control selectpicker validation-field" 
                                                                        id="idioma" formControlName="idioma">
                                                                    <option [ngValue]="null" translate>No Indicado</option>                     
                                                                    <ng-container *ngFor="let opcion of msg.cacheColecciones['AuxIdiomas']">
                                                                        <option *ngIf="ValidaDocumentoIsActivo(opcion.key, opcion.settings.isActivo, form.value.idioma)"
                                                                                [ngValue]="opcion.key">{{opcion.nombre | translate}}</option>
                                                                    </ng-container>
                                                                </select>
                                                                <small *ngIf="form.controls.idioma.touched && form.controls.idioma.errors?.required" class="text-danger"><span translate>claseFicha.idioma</span>&nbsp;<span translate>claseValidaciones.esRequerido</span></small>
                                                            </div>
                                                            


                                                            <!-- Distribuidor Asignado -->
                                                            <div class="form-group">
                                                                <label class="text-gray" translate>moduloOrganizaciones.distribuidorAsignado<span class="required">*</span></label>

                                                                <select class="form-control selectpicker validation-field" 
                                                                        id="distribuidor" formControlName="distribuidor"
                                                                        [compareWith]="compareFn">
                                                                    <option [ngValue]="null" *ngIf="msg.cacheColecciones['Distribuidores'].length>1">{{'No Indicado' | translate}}</option>                          
                                                                    <ng-container *ngFor="let opcion of msg.cacheColecciones['Distribuidores']">    
                                                                        <option [ngValue]="opcion">{{opcion.nombre}}</option>
                                                                    </ng-container>            
                                                                </select>

                                                               <small class="text-danger" *ngIf="form.controls.distribuidor.touched && form.controls.distribuidor.errors?.required"><span translate>moduloOrganizaciones.distribuidorAsignado</span>&nbsp;<span translate>claseValidaciones.esRequerido</span></small>                      
                                                            </div>

                                                    </div> <!-- FIN card-body -->
                                                </div> <!-- FIN widget -->

                                                <!-- esquema comercial -->
                                                <div widget class="card border-0 box-shadow" style="margin-top:20px;">
                                                    <div class="card-header transparent border-0 text-muted">
                                                        <h5 class="mb-0" translate>claseTabs.esquemaComercial</h5>
                                                        <div class="widget-controls"> 
                                                            <a data-widgster="expand" href="#" class="transition"><i class="fa fa-chevron-down"></i></a>
                                                            <a data-widgster="collapse" href="#" class="transition"><i class="fa fa-chevron-up"></i></a>
                                                        </div>        
                                                    </div>
                                                    
                                                    <div class="card-body pt-0 widget-body row mb-4" formGroupName="esquemaComercial"> 
                                                       
                                                        <div class="row align-items-center mx-2"> 

                                                     <!-- Primer Fila -->        
                                                            <div class="form-group col-6">
                                                                <label class="text-gray" translate>moduloOrganizaciones.cantidadLicencias<span class="required">*</span></label>
                                                                <input formControlName="cantidadLicencias" class="form-control validation-field" type="text">

                                                                <small class="text-danger" 
                                                                       *ngIf="form.get('esquemaComercial').get('cantidadLicencias').touched && 
                                                                       form.get('esquemaComercial').get('cantidadLicencias').errors?.required"><span translate>moduloOrganizaciones.cantidadLicencias</span>&nbsp;<span translate>moduloOrganizaciones.esRequerido</span></small>
                                                            </div>

                                                            <div class="form-group col-6">
                                                                <label class="text-gray" translate>moduloOrganizaciones.porcentajeExcesoPermitido<span class="required">*</span></label>
                                                                <input formControlName="porcentajeExcesoPermitido" class="form-control validation-field" type="text">

                                                                <small class="text-danger" 
                                                                       *ngIf="form.get('esquemaComercial').get('porcentajeExcesoPermitido').touched && 
                                                                       form.get('esquemaComercial').get('porcentajeExcesoPermitido').errors?.required"><span translate>moduloOrganizaciones.porcentajeExcesoPermitido</span>&nbsp;<span translate>moduloOrganizaciones.esRequerido</span></small>
                                                            </div>    
                                                            
                                                            <div class="form-group col-6">
                                                                <label class="text-gray" translate>moduloOrganizaciones.cantidadVecesExcesoPermitido<span class="required">*</span></label>
                                                                <input formControlName="cantidadVecesExcesoPermitido" class="form-control validation-field" type="text">

                                                                <small class="text-danger" 
                                                                       *ngIf="form.get('esquemaComercial').get('cantidadVecesExcesoPermitido').touched && 
                                                                       form.get('esquemaComercial').get('cantidadVecesExcesoPermitido').errors?.required"><span translate>moduloOrganizaciones.cantidadVecesExcesoPermitido</span>&nbsp;<span translate>moduloOrganizaciones.esRequerido</span></small>
                                                            </div> 

                                                            <div class="custom-control custom-checkbox col-6 ">
                                                                <input type="checkbox" class="custom-control-input checkbox-dark-gray" 
                                                                       id="checkboxLicenciasConBloquer" formControlName="licenciasConBloqueo" 
                                                                       [value]="form.value.esquemaComercial.licenciasConBloqueo">
                                                                <label class="custom-control-label" for="checkboxLicenciasConBloquer" translate>moduloOrganizaciones.licenciasConBloqueo</label>
                                                            </div> 

                                                                                                         
                                                            <div class="custom-control custom-checkbox col-3 ml-3" >
                                                                <input type="checkbox" class="custom-control-input checkbox-dark-gray" 
                                                                       id="checkboxLogAuditoria" formControlName="logAuditoria" 
                                                                       [value]="form.value.esquemaComercial.logAuditoria">
                                                                <label class="custom-control-label" for="checkboxLogAuditoria" translate>moduloOrganizaciones.logAuditoria</label>
                                                            </div> 
                                                        
                                                            <div class="custom-control custom-checkbox col-3" >
                                                            <input type="checkbox" class="custom-control-input checkbox-dark-gray" 
                                                                    id="checkboxLogEstadosCelular" formControlName="logEstadosCelular" 
                                                                    [value]="form.value.esquemaComercial.logEstadosCelular">
                                                                <label class="custom-control-label" for="checkboxLogEstadosCelular" translate>moduloOrganizaciones.logEstadosCelular</label>
                                                             </div> 

                                                            <div class="custom-control custom-checkbox col-3">
                                                                <input type="checkbox" class="custom-control-input checkbox-dark-gray" 
                                                                    id="checkboxTrackeaInBackgroundAppClose" formControlName="trackeaInBackgroundAppClose" 
                                                                    [value]="form.value.esquemaComercial.trackeaInBackgroundAppClose">
                                                                <label class="custom-control-label" for="checkboxTrackeaInBackgroundAppClose" translate>moduloOrganizaciones.trackeaInBackgroundAppClose</label>
                                                            </div> 
   
                                                            <div class="col-2"></div>
                                                <!-- Tercer Fila -->
                                                            <div class="line"></div>
                                                            <div class="custom-control custom-checkbox col-3 ml-3" >
                                                                <input type="checkbox" class="custom-control-input checkbox-dark-gray" 
                                                                       id="checkboxrelevamientoParadas" formControlName="relevamientoParadas" 
                                                                       [value]="form.value.esquemaComercial.relevamientoParadas">
                                                                <label class="custom-control-label" for="checkboxrelevamientoParadas" translate>moduloOrganizaciones.relevamientoParadas</label>
                                                            </div> 

                                                            <div class="custom-control col-3 custom-checkbox" >
                                                                <input type="checkbox" class="custom-control-input checkbox-dark-gray" 
                                                                       id="checkboxhojaDeRutas" formControlName="hojaDeRutas" 
                                                                       [value]="form.value.esquemaComercial.hojaDeRutas">
                                                                <label class="custom-control-label" for="checkboxhojaDeRutas" translate>moduloOrganizaciones.hojaDeRutas</label>
                                                            </div> 

                                                            <div class="custom-control custom-checkbox col-3" >
                                                                <input type="checkbox" class="custom-control-input checkbox-dark-gray" 
                                                                       id="checkboxGestionaParadas" formControlName="gestionaParadas" 
                                                                       [value]="form.value.esquemaComercial.gestionaParadas">
                                                                <label class="custom-control-label" for="checkboxGestionaParadas" translate>moduloOrganizaciones.gestionaParadas</label>
                                                            </div> 
                                                            <div class="col-2"></div>
                                                            <!-- <div class="form-group col-4">
                                                                <label class="text-gray" translate>moduloRutas.hojaRutaFicha<span class="required">*</span></label>

                                                                <select class="form-control selectpicker validation-field" 
                                                                        id="hojaRutaFicha" formControlName="hojaRutaFicha">
                                                                    <ng-container *ngFor="let opcion of listadoOpcionesHojaRuta">    
                                                                        <option [ngValue]="opcion">{{opcion | translate}}</option>
                                                                    </ng-container>            
                                                                </select>
                                                            </div> -->

                                                            <div class="line"></div>
                                                            <div class="custom-control custom-checkbox col-4  ml-3" >
                                                                <input type="checkbox" class="custom-control-input checkbox-dark-gray" 
                                                                       id="checkboxTrackeaRutas" formControlName="trackeaRutas" 
                                                                       [value]="form.value.esquemaComercial.trackeaRutas">
                                                                <label class="custom-control-label" for="checkboxTrackeaRutas" translate>moduloOrganizaciones.trackeaRutas</label>
                                                            </div> 
                                                        
                                                        </div>                                                                


                                                            
                                                    </div> <!-- FIN card-body -->
                                                </div> <!-- FIN widget -->

                                                <!-- SOAP -->
                                                <div widget class="card border-0 box-shadow" style="margin-top:20px;">
                                                    <div class="card-header transparent border-0 text-muted">
                                                        <h5 class="mb-0" translate>soap.importacionSoap</h5>
                                                        <div class="widget-controls"> 
                                                            <a data-widgster="expand" href="#" class="transition"><i class="fa fa-chevron-down"></i></a>
                                                            <a data-widgster="collapse" href="#" class="transition"><i class="fa fa-chevron-up"></i></a>
                                                        </div>        
                                                    </div>
                                                    <div class="card-body pt-0 widget-body" formGroupName="soap"> 

                                                            <div class="form-group">
                                                                <label class="text-gray" translate>soap.hostRoadNet</label>
                                                                <input formControlName="hostRoadNet" class="form-control validation-field" type="text">

                                                                <small class="text-danger" 
                                                                       *ngIf="form.get('soap').get('hostRoadNet').touched && 
                                                                       form.get('soap').get('hostRoadNet').errors?.required"><span translate>soap.hostRoadNet</span>&nbsp;<span translate>moduloOrganizaciones.esRequerido</span></small>

                                                            </div>

                                                            <div class="form-group">
                                                                <label class="text-gray" translate>soap.hostTerritoryPlanner</label>
                                                                <input formControlName="hostTerritoryPlanner" class="form-control validation-field" type="text">

                                                                <small class="text-danger" 
                                                                       *ngIf="form.get('soap').get('hostTerritoryPlanner').touched && 
                                                                       form.get('soap').get('hostTerritoryPlanner').errors?.required"><span translate>soap.hostRoadNet</span>&nbsp;<span translate>moduloOrganizaciones.esRequerido</span></small>

                                                            </div>
                                                            
                                                    </div> <!-- FIN card-body -->
                                                </div> <!-- FIN widget -->
                                                
                                                <!-- Redes Sociales --->    
                                                <lib-shared-form-redSocial 
                                                [nameField]="'redSocial'" 
                                                [controlsField]="form.controls.redSocial"
                                                [value]="form.value.redSocial"
                                                [accionForm]="accionForm" 
                                                [formInvalid]="formInvalid" 
                                                (cargoSubEstructura)="emitCargoSubEstructura($event)"></lib-shared-form-redSocial>
                                                
                                        </div>  <!-- FIN col-xl-6 mb-4 -->

                                        <div class="col-xl-6 mb-4">

                                                <!-- ********** dirección ********** -->
                                                <lib-shared-form-direccion 
                                                [nameField]="'direccion'" 
                                                [etiquetaField]="'claseTabs.direccion'" 
                                                [controlsField]="form.controls.direccion"
                                                [value]="form.value.direccion"
                                                [accionForm]="accionForm" 
                                                [formInvalid]="formInvalid" 
                                                [organizacionKNAI]="this.organizacionKNAI"
                                                [usuarioKANE]="usuarioKANE"
                                                [nombreColeccion]="nombreColeccion"                                    
                                                (cargoSubEstructura)="emitCargoSubEstructura($event)"></lib-shared-form-direccion>
                                            
                                                <!-- Telefono -->
                                                <lib-shared-form-telefono 
                                                [nameField]="'telefono'" 
                                                [controlsField]="form.controls.telefono"
                                                [value]="form.value.telefono"
                                                [accionForm]="accionForm" 
                                                [formInvalid]="formInvalid" 
                                                (cargoSubEstructura)="emitCargoSubEstructura($event)"></lib-shared-form-telefono>
                                                
                                                <!-- settings   -->
                                                <lib-shared-form-settings *ngIf="accionForm!='agregar'"
                                                [nameField]="'settings'" 
                                                [controlsField]="form.controls.settings"
                                                [value]="form.value.settings"
                                                [accionForm]="permisos.modificacionesBasicasAutorizadas ? 'consultar' : accionForm" 
                                                [formInvalid]="formInvalid" 
                                                [tipoPerfilUsuario]="tipoPerfilUsuario"
                                                (cargoSubEstructura)="emitCargoSubEstructura($event)"></lib-shared-form-settings>
                                                

                                        </div> <!-- fin div class="col-xl-6 -->

                                    </div> <!-- fin div class="row -->


                                    <lib-shared-form-buttons [accionForm]='accionForm' 
                                                      [permisos]='permisos' 
                                                      (setAccion)="setAccionForm($event)"
                                                      (onSubmitComponent)="onSubmit(form.value)"></lib-shared-form-buttons>

                        </form> 


                </div> <!-- FIN tab-pane id="ta" -->

                <div class="tab-pane" id="tb">
                    <app-organizaciones-sucursales 
                        [organizacionInputKNAI]="this.fn.setearOrganizacionKNAI(form.value)"
                        [permisosInput]="permisos">                        
                    </app-organizaciones-sucursales>
                </div>

                <div class="tab-pane" id="tc">
                    <app-organizaciones-areas-negocio 
                        [organizacionInputKNAI]="this.fn.setearOrganizacionKNAI(form.value)"
                        [permisosInput]="permisos">                        
                    </app-organizaciones-areas-negocio>
                </div>

                <div class="tab-pane" id="td">
                    <app-organizaciones-ubicaciones 
                        [organizacionInputKNAI]="this.fn.setearOrganizacionKNAI(form.value)"
                        [permisosInput]="permisos">                        
                    </app-organizaciones-ubicaciones>
                </div>

            </div>                   

        </div>
    </div>

</div>